<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script> 
<!-- This is the API from Firebase Realtime Database -->
<script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script> 
<!-- API for Firebase Storage -->
<script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-storage.js"></script> 

<button onclick="getUserDetails(0)">Testing</button>
<input type="file" id="photo">
<button onclick="uploadImage()">Upload Trial</button>
</br><hr></br>
<table border="1">
  <tbody id="details">

  </tbody>
</table>


<script>
  // Your web app's Firebase configuration
  // You can find yours at Firebase -> Project Overview -> Project Settings
  // -> SDK setup and configuration -> CDN
  const firebaseConfig = {
  apiKey: "AIzaSyAWvVP_h1HKDOSqjp9BFZ1ttifg_UhC0eQ",
  authDomain: "is216-webapp.firebaseapp.com",
  databaseURL: "https://is216-webapp-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "is216-webapp",
  storageBucket: "is216-webapp.appspot.com",
  messagingSenderId: "113592009297",
  appId: "1:113592009297:web:fd8286678c0c18abc3ee70"
};
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  function uploadImage(){
    const ref = firebase.storage().ref()

    const file = document.querySelector("#photo").files[0]

    const name = new Date() + '-' + file.name

    const task = ref.child(name).put(file)

    task
    .then(snapshot => snapshot.ref.getDownloadURL())
    .then(url =>{
      console.log(url)
      alert("Image upload successful")
    })
  }

  function getUserDetails(userId) {
    var user = firebase.database().ref('adoption/' + userId);
    user.once('value').then((snapshot) => {
    if(snapshot.exists()) {
      console.log("Found")
      console.log(snapshot.val())
      username = snapshot.val().username
      animalname = snapshot.val().animalname
      species = snapshot.val().species
      age = snapshot.val().age
      description = snapshot.val().description
      email = snapshot.val().email
      phone = snapshot.val().phone
      address = snapshot.val().address
      image = snapshot.val().image
      tableText = `
        <tr>
          <th>Username</th>
          <th>${username}</th>
        </tr>
        <tr>
          <th>Pet Name</th>
          <th>${animalname}</th>
        </tr>
        <tr>
          <th>Species</th>
          <th>${species}</th>
        </tr>
        <tr>
          <th>Age</th>
          <th>${age}</th>
        </tr>
        <tr>
          <th>Description</th>
          <th>${description}</th>
        </tr>
        <tr>
          <th>Email</th>
          <th>${email}</th>
        </tr>
        <tr>
          <th>Phone Number</th>
          <th>${phone}</th>
        </tr>
        <tr>
          <th>Address</th>
          <th>${address}</th>
        </tr>
        <tr>
          <th>Image</th>
          <th><img src="${image}"></th>
        </tr>
      `
      document.getElementById("details").innerHTML = tableText

    }
    else {
      console.log("Not Found")
    }
    });
    }

    </script>
</body>
</html>